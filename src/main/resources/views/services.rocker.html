@import java.util.Map
@import java.util.List
@import technology.iatlas.spaceup.dto.Service
@import technology.iatlas.spaceup.dto.Navigation
@import technology.iatlas.spaceup.dto.ServiceOption

@args (List<Navigation> navigations, List<Service> services, List<ServiceOption> options)

    @extrajs => {
    <script type="module">
        import {serviceExecute} from "/js/modules/Service.js"
        @for(service: services) {
            @for(option: options) {
                $(document).on("click", "***REMOVED***execute_@service.getName()_@option.name()", function(e) {
                    serviceExecute("@service.getName()", "@option.name()");
                    e.preventDefault();
                });
            }
        }
    </script>
    }

@views.base.template("Services", navigations, extrajs) -> {
    <div>
        <h4>Deine Services</h4>
    </div>
    <div class="row">
        @for (service : services) {
        <div class="col s12 m4">
            <span id="content_@service.getName()">
                <div class="card hoverable">
                    <div id="card_@service.getName()" class="card-content">
                    <h5>@service.getName()</h5>
                    <hr>
                    <p>
                        Status: @service.getStatus()<br/>
                        @service.getInfo()
                    </p>
                    </div>
                    <div class="card-action">
                        @for(option: options) {
                            <a id="execute_@service.getName()_@option.name()">@option.name()</a>
                        }
                    </div>
                </div>
            </span>
        </div>
        }
    </div>

    <script>
        $(document).ready(function(){
            let serviceList = [];
            @for(service: services) {
                serviceList.push({
                    name: "@service.getName()",
                    status: "@service.getStatus()",
                    info: "@service.getInfo()"
                });
            }
            serviceList.forEach(s => {
                if(s.status === "FATAL" || s.status.includes("STOP")) {
                    $("***REMOVED***card_" + s.name).addClass("error");
                }
            })
        });
    </script>
    }